C****
      SUBROUTINE PMONTH (
     I                   NCH,    ITYP,   JDAY,   ALAT,
     I                   GREEN, ZLT, Z0, D, BUG,
     O                   SQSCAT, Z2, DZM,
     O                   RSOIL1, RSOIL2, SATCAP, RDC,  U2FAC
     &                  )

      IMPLICIT NONE

c****     This subroutine sets seasonally varying
c****  variables.  NOTE: LAI is stored as LAI (SIB) / VCOVER (SIB).
c****
      INTEGER MONTHs, ntyps
      PARAMETER (MONTHS = 13)
      parameter (NTYPS = 10)
c****
      LOGICAL*1 BUG
      INTEGER NCH
      INTEGER ITYP(NCH), JDAY
c****
c**** IntegerTYPe:  Vegetation types (biomes).
c****     1:  BrdEvr:  Broadleaf evergreen.
c****     2:  BrdDcd:  Broadleaf deciduous.
c****     3:  Needle:  Needleleaf trees.
c****     4:  GndCvr:  Groundcover (grass).
c****
      REAL GREEN(NCH),  ZLT(NCH),    SQSCAT(NCH), Z0(NCH),
     &     Z2(NCH),     D(NCH),      DZM(NCH),    RSOIL1(NCH),
     &     RSOIL2(NCH), SATCAP(NCH), RDC(NCH),    U2FAC(NCH),
     &     ALAT(NCH)
c****
      INTEGER ChNo, K, KDAY, KLOW
c****
      REAL VGRDC(MONTHS,NTYPS),  VGROTL(MONTHS,NTYPS),
     &     VGZ0(MONTHS,NTYPS),   VGDD(MONTHS,NTYPS),
     &     VGRF11(NTYPS),         VGRF12(NTYPS),
     &     VGTR11(NTYPS),         VGTR12(NTYPS),
     &     VGROCA(NTYPS),         VGROTD(NTYPS),
     &     VGRDRS(NTYPS),         VGZ2(NTYPS)
c****
      REAL AKDAY0(MONTHS), ALPHAF, CUNI, DUM1, DUM2, ROOTL, SCAT,
     &   VKC, VROOT, WHI, WLO, RLENGT, DPARAM
c****
c**** --------------------------------------------------------------------
c****

      DATA VGRDC/285.87,285.87,285.87,285.87,285.87,285.87,285.87,
     1   285.87, 285.87, 285.87, 285.87, 285.87, 285.87, 
     2   211.32, 211.32, 218.78, 243.40, 294.87, 345.90, 355.18,
     2   341.84, 307.22, 244.84, 218.78, 211.32, 211.32, 
     3   565.41, 587.05, 623.46, 638.13, 652.86, 675.04, 660.24, 
     3   645.49, 638.13, 623.46, 587.05, 565.41, 565.41, 
     4    24.43,  24.63,  24.80,  24.96,  25.72,  27.74,  30.06,
     4    28.86,  25.90,  25.11,  24.80,  24.63,  24.43, 
     5   103.60, 103.60, 102.35, 100.72, 100.72, 100.72, 100.72,
     5   105.30, 107.94, 106.59, 104.49, 103.60, 103.60, 
     6    22.86,  22.86,  22.86,  22.86,  22.86,  23.01,  24.36,
     6    24.69,  24.04,  22.86,  22.86,  22.86,  22.86, 
     7    23.76,  23.76,  23.76,  23.76,  23.76,  23.76,  23.76,
     7    23.76,  23.76,  23.76,  23.76,  23.76,  23.76, 
     8    23.76,  23.76,  23.76,  23.76,  23.76,  23.76,  23.76,
     8    23.76,  23.76,  23.76,  23.76,  23.76,  23.76, 
     9    23.76,  23.76,  23.76,  23.76,  23.76,  23.76,  23.76,
     9    23.76,  23.76,  23.76,  23.76,  23.76,  23.76, 
     A    23.76,  23.76,  23.76,  23.76,  23.76,  23.76,  23.76,
     A    23.76,  23.76,  23.76,  23.76,  23.76,  23.76/

      DATA VGROTL/19737.8,19737.8,19737.8,19737.8,19737.8,19737.8,
     1  19737.8, 19737.8, 19737.8, 19737.8, 19737.8, 19737.8, 19737.8,
     2    5010.0,  5010.0,  5270.0,  6200.0,  8000.0,  9700.0,  9500.0,
     2    8400.0,  6250.0,  5270.0,  5010.0,  5010.0,  5010.0,
     3    9000.0,  9200.0,  9533.3,  9666.7,  9800.0,  9866.7,  9733.3, 
     3    9666.7,  9533.3,  9200.0,  9000.0,  9000.0,  9000.0,
     4    5500.0,  5625.0,  5750.0,  5875.0,  6625.0,  8750.0,  9375.0,
     4    6875.0,  6000.0,  5750.0,  5625.0,  5500.0,  5500.0,
     5    6500.0,  6000.0,  5500.0,  5500.0,  5500.0,  5500.0,  5500.0,
     5    7500.0,  8500.0,  7000.0,  6500.0,  6500.0,  6500.0,
     6   10625.0, 10625.0, 10625.0, 10625.0, 10625.0, 11250.0, 18750.0,
     6   17500.0, 10625.0, 10625.0, 10625.0, 10625.0, 10625.0,
     7       1.0,     1.0,     1.0,     1.0,     1.0,     1.0,     1.0,
     7       1.0,     1.0,     1.0,     1.0,     1.0,     1.0,
     8       1.0,     1.0,     1.0,     1.0,     1.0,     1.0,     1.0,
     8       1.0,     1.0,     1.0,     1.0,     1.0,     1.0,
     9       1.0,     1.0,     1.0,     1.0,     1.0,     1.0,     1.0,
     9       1.0,     1.0,     1.0,     1.0,     1.0,     1.0,
     A       1.0,     1.0,     1.0,     1.0,     1.0,     1.0,     1.0,
     A       1.0,     1.0,     1.0,     1.0,     1.0,     1.0/

      DATA VGZ0/2.6530, 2.6530, 2.6530, 2.6530, 2.6530, 2.6530, 2.6530, 
     1   2.6530, 2.6530, 2.6530, 2.6530, 2.6530, 2.6530,  
     2   0.5200, 0.5200, 0.6660, 0.9100, 1.0310, 1.0440, 1.0420,
     2   1.0370, 1.0360, 0.9170, 0.6660, 0.5200, 0.5200, 
     3   1.1120, 1.1030, 1.0880, 1.0820, 1.0760, 1.0680, 1.0730,
     3   1.0790, 1.0820, 1.0880, 1.1030, 1.1120, 1.1120, 
     4   0.0777, 0.0778, 0.0778, 0.0779, 0.0778, 0.0771, 0.0759,
     4   0.0766, 0.0778, 0.0779, 0.0778, 0.0778, 0.0777, 
     5   0.2450, 0.2450, 0.2270, 0.2000, 0.2000, 0.2000, 0.2000,
     5   0.267,  0.292,  0.280,  0.258,  0.2450, 0.2450,  
     6   0.0752, 0.0752, 0.0752, 0.0752, 0.0752, 0.0757, 0.0777,
     6   0.0778, 0.0774, 0.0752, 0.0752, 0.0752, 0.0752, 
     7   0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 
     7   0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 
     8   0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 
     8   0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 
     9   0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 
     9   0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112,
     A   0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 
     A   0.0112, 0.0112, 0.0112, 0.0112, 0.0112, 0.0112/

      DATA VGDD/27.37, 27.37, 27.37, 27.37, 27.37, 27.37, 27.37,
     1   27.37,   27.37,   27.37,   27.37,   27.37,   27.37, 
     2   13.66,   13.66,   14.62,   15.70,   16.33,   16.62,   16.66,
     2   16.60,   16.41,   15.73,   14.62,   13.66,   13.66, 
     3   13.76,   13.80,   13.86,   13.88,   13.90,   13.93,   13.91,
     3   13.89,   13.88,   13.86,   13.80,   13.76,   13.76, 
     4    0.218,   0.227,   0.233,   0.239,   0.260,   0.299,   0.325,
     4    0.313,   0.265,   0.244,   0.233,   0.227,   0.218,  
     5    2.813,   2.813,   2.662,   2.391,   2.391,   2.391,   2.391,
     5    2.975,   3.138,   3.062,   2.907,   2.813,   2.813,  
     6    0.10629, 0.10629, 0.10629, 0.10629, 0.10629, 0.12299, 0.21521,
     6    0.22897, 0.19961, 0.10629, 0.10629, 0.10629, 0.10629,  
     7    0.0001,  0.0001,  0.0001,  0.0001,  0.0001,  0.0001,  0.0001,
     7    0.0001,  0.0001,  0.0001,  0.0001,  0.0001,  0.0001, 
     8    0.0001,  0.0001,  0.0001,  0.0001,  0.0001,  0.0001,  0.0001,
     8    0.0001,  0.0001,  0.0001,  0.0001,  0.0001,  0.0001, 
     9    0.0001,  0.0001,  0.0001,  0.0001,  0.0001,  0.0001,  0.0001,
     9    0.0001,  0.0001,  0.0001,  0.0001,  0.0001,  0.0001,
     A    0.0001,  0.0001,  0.0001,  0.0001,  0.0001,  0.0001,  0.0001,
     A    0.0001,  0.0001,  0.0001,  0.0001,  0.0001,  0.0001/

      DATA VGRF11 /0.10, 0.10, 0.07, 0.105
     *, 0.10, 0.10, .001, .001, .001, .001/

      DATA VGRF12 /0.16, 0.16, 0.16, 0.360
     *, 0.16, 0.16, .001, .001, .001, .001/

      DATA VGTR11 /0.05, 0.05, 0.05, 0.070
     *, 0.05, 0.05, .001, .001, .001, .001/

      DATA VGTR12 /.001, .001, .001,  .220
     *, .001, .001, .001, .001, .001, .001/

      DATA VGROCA /
     &  0.384E-6, 0.384E-6, 0.384E-6, 0.384E-6, 0.384E-6, 0.384E-6,
     &   .1E-6, .1E-6, .1E-6, .1E-6  / 

      DATA VGROTD /1.00, 1.00, 0.50, 0.50, 0.50, 0.20, 0.10, 0.10,
     &  0.10, 0.10/ 

      DATA VGRDRS  /
     &   0.75E13, 0.75E13, 0.75E13, 0.40E13, 0.75E13, 0.75E13,
     &   0.10E13, 0.10E13, 0.10E13, 0.10E13  /

      DATA VGZ2 /35.0, 20.0, 17.0, 0.6, 5.0, 0.6, 0.1, 0.1, 0.1, 0.1/

      DATA AKDAY0 / 16.,  45.,  75., 105., 136., 166., 197., 228., 258.,
     &             289., 319., 350., 381.
     &            /

      DATA VKC /0.35/


      DO 20 ChNo = 1, NCH
C****
C**** DETERMINE WEIGHTING FACTOR:
      IF (ALAT(CHNO) .LT. 0.) THEN
        KDAY = MOD (182 + JDAY, 365)
      ELSE
        KDAY = MOD (365 + JDAY, 365)
      ENDIF

C****
      KLOW = 12

      DO 10 K = 1, 12
        IF (KDAY .GE. AKDAY0 (K)) KLOW = K
   10 CONTINUE

      IF (KLOW .EQ. 12 .AND. KDAY .LT. AKDAY0 (12)) THEN
        WLO = (16. - KDAY) / 31.
      ELSE
        WLO = (AKDAY0 (KLOW + 1) - KDAY) /
     &        (AKDAY0 (KLOW + 1) - AKDAY0 (KLOW))
      ENDIF

      WHI = 1 - WLO

C****
C**** COMPUTE SOME PARAMETERS DIRECTLY:
        RDC (ChNo) = WLO * VGRDC (KLOW, ITYP (ChNo)) +
     &               WHI * VGRDC (KLOW + 1, ITYP (ChNo))
        ROOTL = WLO * VGROTL (KLOW, ITYP (ChNo)) +
     &          WHI * VGROTL (KLOW + 1, ITYP (ChNo))
        RLENGT=WLO*VGZ0(KLOW,ITYP(ChNo)) +
     &          WHI*VGZ0(KLOW+1,ITYP(ChNo))
        DPARAM=WLO*VGDD(KLOW,ITYP(ChNo)) +
     &          WHI*VGDD(KLOW+1,ITYP(ChNo))

        VROOT = ROOTL * VGROCA (ITYP (ChNo))
        DUM1 = ALOG (VROOT / (1 - VROOT))
        DUM2 = 1. / (8. * 3.14159 * ROOTL)
        ALPHAF = DUM2 * (VROOT - 3. -2. * DUM1)
        RSOIL1 (ChNo) =
     &    VGRDRS (ITYP (ChNo)) / (ROOTL * VGROTD (ITYP (ChNo)))
        RSOIL2 (ChNo) = ALPHAF / VGROTD (ITYP (ChNo))
C****
        SCAT = GREEN (ChNo) *
     &         (VGTR11 (ITYP (ChNo)) + VGRF11 (ITYP (ChNo))) +
     &         (1. - GREEN (ChNo)) *
     &         (VGTR12 (ITYP (ChNo)) + VGRF12 (ITYP (ChNo)))
        SQSCAT (ChNo) = SQRT (1. - SCAT)

        IF ( (BUG .EQV. .TRUE.)  .AND. (ChNo .eq. 1)) THEN
           WRITE(*,*) 'PMON: GREEN(1)=', GREEN(ChNo)
           WRITE(*,*) 'PMON: SCAT=',SCAT
           WRITE(*,*) 'PMON: SQSCAT=',SQSCAT(ChNo)
        ENDIF

C****
        DZM (ChNo) = 600.

C****  
        CUNI = (ALOG (0.025 * DZM (ChNo) / RLENGT) / VKC) + 8.4
        U2FAC (ChNo) =
     &    ALOG ((VGZ2 (ITYP (ChNo)) - DPARAM) / RLENGT) /
     &    (CUNI * VKC)
        Z2 (ChNo) = VGZ2 (ITYP (ChNo))
C****
        SATCAP (ChNo) = 0.2 * ZLT (ChNo)
 20   CONTINUE

C****
      RETURN
      END
C****

* [ END PMONTH ]
c****
